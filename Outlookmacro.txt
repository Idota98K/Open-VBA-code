Sub GetMail()
    Dim oApp As New Outlook.Application
    Dim oNs As Outlook.Namespace
    Dim maillist As Items
    Dim days
    Dim oF As Folder
    Dim i As Long
    Dim today As Date
    Dim strFilter As String
    Dim Filtercount As Long
    Dim count(100) As Long
    Dim ccc(10) As String
    Set oNs = oApp.GetNamespace("MAPI")
    Set oF = oNs.GetDefaultFolder(olFolderInbox)
    today = Date
    days = DateAdd("d", -7, Date)
    
    strFilter = "[受信日時] <= '" & Now & _
                 "' AND [受信日時] >= '" & days & " 23:59'"
    Set maillist = oF.Items.Restrict(strFilter)
    maillist.Sort "[ReceivedTime]", True
    
    
'↓この書き方でも時間指定できる
'        If DateValue(maillist.Item(i).ReceivedTime) <= days Then
'            If InStr(maillist.Item(i).Subject, "MARUI") Then
'                Cells(i, 1).Value = maillist.Item(i).Subject
'            End If
'        End If
    
    Filtercount = 0
    For i = 1 To maillist.count
        If InStr(maillist.Item(i).Subject, "MARUI") Then
            count(Filtercount + 1) = i
            Filtercount = Filtercount + 1
        End If
    Next
    
    For i = 1 To Filtercount
        Cells(i, 1).Value = maillist.Item(count(i)).Subject
'        ccc(i) = maillist.Item(count(i)).Subject 条件指定して文章入れれる
    Next
    
End Sub